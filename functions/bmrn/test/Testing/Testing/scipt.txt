library(test)

file = list(datapath = 'Testing/Testing/Test Case 2/test_data2.xlsx')

data = clean_excel_data(file)$data %>%
  mutate(
    TypeNew = Type,
    TreatmentNew = Treatment,
    trt = TreatmentNew,
    TreatmentNew = replace_na(TreatmentNew, "Wild Type"),
    basic_model = str_detect(TreatmentNew, "Vehicle|Treatment"))

data_long = data %>%
  pivot_longer(cols = grep('Time', colnames(.), value = TRUE),
               values_to = 'Response', names_to = 'Time')
source('R/cor_select.R')

#Change baseline = TRUE for Test case 5
transformed_data = pre_modeling(data_long, baseline = FALSE)
final_data <- final_modeling(transformed_data, toi = 'Time 6', analysis_type = 'confirm')



